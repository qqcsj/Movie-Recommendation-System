<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§’è‰²æŠ•ç¥¨æ‰‹è´¦ï¼ˆæœ€ç»ˆç²¾ä¿®ç‰ˆï¼‰</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Long+Cang&display=swap" rel="stylesheet">

    <style>
        /* ================= åŸºç¡€æ ·å¼ ================= */
        body {
        margin: 0;
         font-family: sans-serif;
         overflow: auto;
          background-color: #f0f2f5; }

        /* 1. æ ¸å¿ƒå®¹å™¨ */
        #vote-entry-btn {
            position: fixed;
            top: 100px; left: 50px;
            width: 140px;
            height: 210px;
            cursor: grab;
            z-index: 9990;
            user-select: none;
            transform: rotate(-3deg);
            transition: transform 0.2s;
        }
        #vote-entry-btn:active { cursor: grabbing; }

        /* â­ï¸ 2. é’¢ç¬”ä¼˜åŒ– (æ›´ç»†ã€æ—‹è½¬è§’åº¦æ›´å¤§) â­ï¸ */
        .pen-wrapper {
            position: absolute;
            top: 40px;
            right: -40px; /* ç¨å¾®è°ƒæ•´ä½ç½® */
            width: 45px;  /* å®½åº¦å˜ç»† (åŸ55px) */
            height: 140px;
            z-index: 20;
            pointer-events: auto;
            filter: drop-shadow(4px 8px 5px rgba(0,0,0,0.4));
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-origin: 50% 50%;
        }
        /* é¼ æ ‡ç¢°åˆ°ç¬”ï¼šè§’åº¦å¢å¤§ï¼Œæ›´è´´è¿‘çº¸å¼  */
        .pen-wrapper:hover {
            transform: rotate(30deg) scale(1.05) translate(-10px, 5px);
            cursor: pointer;
        }

        /* 3. çº¸å¼ éƒ¨åˆ† */
        .paper-wrapper {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: auto;
            transform-origin: center 20%;
        }
        @keyframes windFloat {
            0%, 100% { transform: rotate(0deg) translateY(0); }  /*rotate(0deg)ï¼šä¸æ—‹è½¬ã€‚translateY(0)ï¼šä¸ç§»åŠ¨ï¼ˆå›åˆ°åŸä½ï¼‰ï¼Œä¿è¯åŠ¨ç”»å¼€å§‹å’Œç»“æŸçš„çŠ¶æ€æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œè¿™æ ·å¾ªç¯æ’­æ”¾æ—¶æ‰ä¼šâ€œæ— ç¼è¡”æ¥â€ï¼Œä¸ä¼šå‡ºç°è·³é¡¿*/
            25% { transform: rotate(2deg) translateY(-2px); }   /*rotate(2deg)ï¼šå‘å³æ­ªä¸€ç‚¹ç‚¹ (é¡ºæ—¶é’ˆæ—‹è½¬ 2 åº¦)ã€‚translateY(-2px)ï¼šå‘ä¸Šé£˜ä¸€ç‚¹ç‚¹ (Yè½´è´Ÿæ•°æ˜¯å‘ä¸Šï¼Œé£˜äº† 2 åƒç´ )*/
            75% { transform: rotate(-1.5deg) translateY(1px); } /*rotate(-1.5deg)ï¼šå‘å·¦æ­ªä¸€ç‚¹ç‚¹ (é€†æ—¶é’ˆæ—‹è½¬ 1.5 åº¦)ã€‚translateY(1px)ï¼šå‘ä¸‹æ²‰ä¸€ç‚¹ç‚¹ (Yè½´æ­£æ•°æ˜¯å‘ä¸‹ï¼Œæ²‰äº† 1 åƒç´ )*/
        }
        .paper-wrapper:hover {
            animation: windFloat 2.5s ease-in-out infinite;
        }
        .paper-svg-container {
            position: absolute;
            width: 100%; height: 100%;
            top: 0; left: 0;
            filter: drop-shadow(2px 5px 3px rgba(0,0,0,0.2));
        }

        /* 4. æ–‡å­—ä¸æ˜Ÿæ˜Ÿ */
        .text-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
        }
        .movable-item {
            position: absolute;
            opacity: 0;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            transition: top 0.5s ease-out, left 0.5s ease-out, opacity 0.3s ease;
        }
        .movable-item.active { opacity: 1; }
        .ink-char {
            font-family: "Long Cang", cursive;
            font-size: 24px;
            color: #2c3e50;
            text-shadow: 0 1px 0 rgba(255,255,255,0.5);
            white-space: nowrap;
        }
        .ink-char.font-special {
            font-family: "Comic Sans MS", cursive;
            font-weight: bold;
            font-size: 20px;
            color: #5d4037;
        }
        /* æ˜Ÿæ˜Ÿ */
        .star-container { width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; z-index: 5; }
        .star-rotator { display: inline-block; transition: transform 1s cubic-bezier(0.25, 1, 0.5, 1); }
        .magic-star { font-size: 26px; display: inline-block; filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.8)); }
        .movable-item.active .magic-star { animation: starPulse 0.8s infinite alternate; }
        @keyframes starPulse { 0% { transform: scale(0.9); } 100% { transform: scale(1.3); } }

        /* ================= 5. é»‘æ¿å¼¹çª—æ ·å¼ ================= */
        #blackboard-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; justify-content: center; align-items: center; }
        .blackboard { width: 90%; max-width: 1000px; height: 85vh; background-color: #2e3b32; border: 15px solid #5d4037; border-radius: 5px; box-shadow: 0 0 20px rgba(0,0,0,0.8), inset 0 0 50px rgba(0,0,0,0.5); position: relative; color: #fff; font-family: "Comic Sans MS", "Chalkboard SE", sans-serif; display: flex; flex-direction: column; padding: 10px 25px; box-sizing: border-box; }
        .board-header { flex-shrink: 0; text-align: center; position: relative; padding-bottom: 10px; border-bottom: 2px dashed rgba(255,255,255,0.3); margin-bottom: 15px; }
        .chalk-title { margin: 10px 0 5px 0; font-size: 2.2rem; color: #fff; text-shadow: 2px 2px 0px #7f8c8d; font-family: inherit; }
        .close-board { position: absolute; top: 0; right: 0; font-size: 35px; line-height: 35px; cursor: pointer; color: #bdc3c7; transition: color 0.2s; }
        .close-board:hover { color: #e74c3c; }
        .board-content { flex-grow: 1; overflow-y: auto; overflow-x: hidden; padding-right: 5px; }
        .board-content::-webkit-scrollbar { width: 8px; }
        .board-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
        .board-content::-webkit-scrollbar-track { background: transparent; }
        .char-grid { display: flex; flex-wrap: wrap; justify-content: space-between; align-content: flex-start; }
        .char-item { width: 49%; background: rgba(255,255,255,0.05); margin-bottom: 12px; padding: 8px 15px; box-sizing: border-box; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1); transition: background 0.2s; }
        .char-item:hover { background: rgba(255,255,255,0.1); }
        .char-info h4 { margin: 0; font-size: 1.1rem; color: #f1c40f; font-family: inherit; text-align: left; }
        .char-info span { font-size: 0.85rem; color: #bdc3c7; text-align: left; margin-top: 3px; }
        .vote-actions { display: flex; gap: 10px; align-items: center; }
        .btn-chalk { background: none; border: 2px solid rgba(255,255,255,0.3); color: white; padding: 4px 12px; border-radius: 20px; cursor: pointer; transition: all 0.2s; outline: none; font-family: inherit; font-size: 0.9rem; }
        .btn-like:hover { border-color: #e74c3c; color: #e74c3c; background: rgba(231, 76, 60, 0.1); }
        .btn-dislike:hover { border-color: #ecf0f1; color: #ecf0f1; background: rgba(255,255,255, 0.1); }

        /* åº•éƒ¨ç¿»é¡µå™¨ */
        .board-footer { flex-shrink: 0; display: flex; justify-content: center; align-items: center; padding-top: 15px; gap: 15px; font-size: 1.2rem; }
        .page-btn { cursor: pointer; user-select: none; color: #fff; border-bottom: 1px solid transparent; }
        .page-btn:hover:not(.disabled) { border-bottom: 1px solid white; color: white; }
        .page-btn.disabled { color: #555; cursor: default; }
        .page-info { color: #95a5a6; font-size: 1rem; }
        .page-jump { display: flex; align-items: center; gap: 5px; margin: 0 10px; }
        .page-jump input { width: 40px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: #f1c40f; text-align: center; border-radius: 4px; padding: 4px; outline: none; font-family: inherit; }
        .page-jump input:focus { border-color: #f1c40f; }
        .btn-jump { background: none; border: 1px solid rgba(255,255,255,0.3); color: #ccc; font-size: 0.9rem; padding: 3px 10px; border-radius: 4px; }
        .btn-jump:hover { border-color: #2ecc71; color: #2ecc71; }

        /* â­ï¸ 6. è‡ªå®šä¹‰è­¦å‘Šå¼¹çª— (å°é»‘æ¿é£æ ¼) â­ï¸ */
        #custom-alert-modal {
            display: none; /* é»˜è®¤éšè— */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 12000; /* æ¯”å¤§é»‘æ¿å±‚çº§æ›´é«˜ */
            justify-content: center; align-items: center;
        }
        .small-blackboard {
            width: 300px; height: 180px;
            background-color: #2e3b32;
            border: 8px solid #5d4037;
            border-radius: 4px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            color: #fff;
            font-family: "Comic Sans MS", "Chalkboard SE", sans-serif;
            text-align: center;
            padding: 20px;
        }
        .alert-msg {
            font-size: 1.2rem;
            margin-bottom: 25px;
            color: #f1c40f;
            letter-spacing: 1px;
        }

        /* â­ï¸ 7. é»‘æ¿æ“¦å½¢çŠ¶çš„æŒ‰é’® â­ï¸ */
        .eraser-btn {
            /* ä¸ŠåŠéƒ¨åˆ†ï¼šæœ¨æŸ„ */
            background-color: #8d6e63;
            background-image: linear-gradient(to bottom, #8d6e63 50%, #5d4037 100%);
            width: 100px;
            height: 35px;
            border: none;
            border-radius: 3px 3px 0 0; /* ä¸Šé¢åœ†è§’ */
            color: white;
            font-size: 1rem;
            cursor: pointer;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            /* ä¸‹åŠéƒ¨åˆ†ï¼šæ¯›æ¯¡å±‚ (é€šè¿‡ box-shadow æˆ– border æ¨¡æ‹Ÿ) */
            border-bottom: 8px solid #333; /* æ¨¡æ‹Ÿé»‘è‰²æ¯›æ¯¡å±‚ */
            display: flex; justify-content: center; align-items: center;
            font-family: inherit;
            transition: transform 0.1s;
        }
        /* å¢åŠ æ¯›æ¯¡çš„çº¹ç†æ„Ÿ */
        .eraser-btn::after {
            content: '';
            position: absolute;
            bottom: -8px; left: 0; width: 100%; height: 8px;
            background: repeating-linear-gradient(90deg, #333, #333 2px, #444 2px, #444 4px);
        }
        .eraser-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 3px rgba(0,0,0,0.3);
        }

        /* ç‰¹æ•ˆåŠ¨ç”» */
        .effect-container {
            position: fixed;
             pointer-events: none;
             z-index: 10001;
              top: 0;
              left: 0;
               width: 100%;
               height: 100%;
               overflow: hidden;
         }
        .anim-heart-float {
            position: absolute;
            font-size: 2rem;
             color: #e74c3c;
             animation: floatHeart 1s ease-out forwards;
         }
        @keyframes floatHeart {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            20% { transform: translateY(-20px) scale(1.2); opacity: 1; }
             100% { transform: translateY(-80px) scale(1.5); opacity: 0; }
             }
        .egg-white-blob {
            position: absolute;
            background: rgba(236, 240, 241, 0.9);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0.9;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
             z-index: 10002;
              animation: splatMain 1.2s ease-out forwards;
          }
        .egg-yolk-blob {
            position: absolute;
            width: 24px;
             height: 24px;
              background: radial-gradient(circle at 35% 35%, #ffeb3b, #fbc02d);
              border-radius: 50%;
              transform: translate(-50%, -50%) scale(0);
              z-index: 10003;
              box-shadow: 1px 1px 3px rgba(0,0,0,0.3);
               animation: splatMain 1.2s ease-out forwards;
               animation-delay: 0.05s;
           }
        .egg-debris {
            position: absolute;
            border-radius: 50%;
            z-index: 10004;
             transform: translate(-50%, -50%);
             opacity: 1;
          }
        @keyframes splatMain {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0.8; }
            15% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            30% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            70% { opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1) translateY(20px); opacity: 0; }
         }

       /* ================== 1. ä¿®æ­£ç‰ˆï¼šçº¯é‡‘æµå…‰æ˜Ÿæ˜Ÿ (æ— è“) ================== */
        /* æŒ‰é’®å®¹å™¨ (ä¿æŒä½ç½®ä¸å˜) */
        .chalk-report-btn {
            position: absolute;
            top: 5px;
            right: 70px;
            width: 60px;
            height: 80px;
            background: transparent;
            border: none;
            cursor: pointer;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            outline: none;
            padding: 0;
            perspective: 500px;
        }

        .star-magnet {
            width: 50px;
            height: 50px;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);

            /* ğŸ¨ ä¿®æ”¹ç‚¹ï¼šçº¯é»„è‰²ç³»é«˜è´¨æ„Ÿæ¸å˜ (é«˜å…‰ç™½é»„ -> çº¯é‡‘ -> æ·±æ©™é‡‘) */
            /* è¿™æ ·ä¼šè®©æ˜Ÿæ˜Ÿçœ‹èµ·æ¥åƒæ˜¯æœ‰å‡¸èµ·çš„ç«‹ä½“æ„Ÿ */
            background: linear-gradient(135deg, #fff176 0%, #ffd700 40%, #ffa500 80%, #ff8c00 100%);

            /* ğŸ§Š è´¨æ„Ÿå¢å¼ºï¼šå†…éƒ¨é«˜å…‰ + å¤–éƒ¨å¾®å¼±æŠ•å½± */
            box-shadow: inset 2px 2px 5px rgba(255,255,255,0.9), inset -2px -2px 5px rgba(184, 134, 11, 0.4);
            filter: drop-shadow(0 3px 2px rgba(0,0,0,0.3));

            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        /* â­ï¸ 3. æ–‡å­—æç¤º (é»˜è®¤éšè—) â­ï¸ */
        .magnet-text {
            margin-top: 5px; /* ç¦»æ˜Ÿæ˜Ÿè¿œä¸€ç‚¹ */
            font-family: "Long Cang", cursive; /* æ‰‹å†™ä½“ */
            font-size: 14px;
            color: #f1c40f; /* é»„è‰²æ–‡å­— */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            opacity: 0; /* é»˜è®¤çœ‹ä¸è§ */
            transform: translateY(-10px); /* é»˜è®¤å¾€ä¸Šé£˜ä¸€ç‚¹ */
            transition: all 0.3s ease;
            pointer-events: none; /* è®©é¼ æ ‡æ— æ³•é€‰ä¸­æ–‡å­—ï¼Œé˜²è¯¯è§¦ */
            white-space: nowrap;
        }

        /* ğŸ–±ï¸ æ‚¬åœç‰¹æ•ˆï¼šæœ¬èº«å˜äº® + çº¯é‡‘è‰²å…‰æ™• (å»æ‰äº†è“è‰²å…‰æ™•) */
        .chalk-report-btn:hover .star-magnet {
            transform: scale(1.15) rotate(144deg);

            /* âœ¨ å‘å…‰ä¿®æ”¹ï¼š
               1. brightness: è®©æœ¬ä½“åƒç¯æ³¡ä¸€æ ·äº®èµ·æ¥
               2. drop-shadow 1: ç´§è´´çš„äº®ç™½å…‰
               3. drop-shadow 2: å‘å¤–æ‰©æ•£çš„é‡‘å…‰
            */
            filter: brightness(1.2)
                    drop-shadow(0 0 5px rgba(255, 255, 200, 1))
                    drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
        }
        /* æ–‡å­—æ˜¾ç° */
        .chalk-report-btn:hover .magnet-text {
            opacity: 1;
            transform: translateY(0);
        }

        /* â­ï¸ 5. é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ â­ï¸ */
        .chalk-report-btn:active .star-magnet {
            transform: scale(0.9) rotate(144deg); /* ä¿æŒæ—‹è½¬è§’åº¦ï¼Œä½†ç¼©å° */
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.5)); /* ç‚¹å‡»æ—¶å…‰èŠ’æ”¶ç¼© */
        }

        /* ç‚¹å‡»æ—¶ï¼Œæ–‡å­—å¼ºåˆ¶æ¶ˆå¤± */
        .chalk-report-btn:active .magnet-text {
            opacity: 0;
            transition: none; /* ç¬é—´æ¶ˆå¤±ï¼Œä¸è¦åŠ¨ç”» */
        }

        /* â­ï¸ ä¿®æ”¹ï¼šè®©æŠ¥è¡¨å¼¹çª—æ›´å¤§ï¼Œå æ»¡å±å¹•å¤§éƒ¨åˆ† */
        .report-overlay {
            position: absolute;
            /* æ‰©å¤§æ˜¾ç¤ºåŒºåŸŸ */
            top: 10px; bottom: 10px; left: 10px; right: 10px;
            background: rgba(46, 59, 50, 0.98);
            z-index: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            border-radius: 8px;
            border: 3px solid rgba(255,255,255,0.3);
            padding: 15px;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }
        .report-img-container {
            flex-grow: 1;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            /* ç»™å›¾ç‰‡å®¹å™¨åŠ ä¸ªæ·±è‰²èƒŒæ™¯ï¼Œçªå‡ºå›¾è¡¨ */
            background-color: #2e3b32;
            border-radius: 4px;
        }
        .report-img-container img {
            /* è®©å›¾ç‰‡å°½å¯èƒ½å¤§ï¼Œä½†ä¿æŒæ¯”ä¾‹ */
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* â­ï¸ æ–°å¢ï¼šåº•éƒ¨å·¥å…·æ  (æ‰€æœ‰æŒ‰é’®æ”¾ä¸€è¡Œ) */
        .report-toolbar {
            margin-top: 15px;
            width: 100%;
            display: flex;
            justify-content: center; /* å±…ä¸­æ’åˆ— */
            align-items: center;
            gap: 30px; /* æŒ‰é’®ç»„ä¹‹é—´çš„é—´è· */
            background: rgba(0,0,0,0.2); /* åº•éƒ¨åŠ æ·±æ¡ */
            padding: 10px;
            border-radius: 50px;
        }

        .report-actions {
            margin-top: 15px;
            display: flex;
            gap: 20px;
        }
        /* æ›´æ–°æŒ‰é’®æ ·å¼ (ç»¿è‰²ç²‰ç¬”) */
        .btn-update {
            background: linear-gradient(90deg, #84fab0 0%, #8fd3f4 100%);
            color: #2e3b32;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            font-family: inherit;
        }
        .btn-update:hover { transform: scale(1.1); }
        .btn-close-report {
            background: transparent;
            border: 1px solid #bdc3c7;
            color: #bdc3c7;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
        }
        .btn-close-report:hover {
            color: white;
            border-color: white;
        }
/* ================== 2. æ–°å¢ï¼šç¦»å¼€ç¡®è®¤å¼¹çª— (å°é»‘æ¿é£æ ¼) ================== */
        #confirm-close-modal {
            display: none; /* é»˜è®¤éšè— */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 12000;
            justify-content: center; align-items: center;
            backdrop-filter: blur(2px);
        }

        .confirm-board {
            width: 380px; height: 220px;
            background-color: #2e3b32;
            border: 12px solid #5d4037; /* æœ¨æ¡† */
            border-radius: 6px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.6), inset 0 0 40px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative;
        }
        /* æœ¨çº¹ç†è£…é¥° */
        .confirm-board::before {
            content: ''; position: absolute; top: -12px; left: -12px; right: -12px; bottom: -12px;
            border: 2px solid rgba(255,255,255,0.1); border-radius: 4px; pointer-events: none;
        }
        .confirm-title-area {
            display: flex; align-items: center; gap: 15px; margin-bottom: 30px;
        }

        /* ğŸ¨ çº¯CSSç”»ä¸€æ ¹ç™½è‰²ç²‰ç¬” */
        .chalk-stick-icon {
            width: 40px; height: 10px;
            background: #fff;
            border-radius: 2px;
            transform: rotate(-15deg);
            box-shadow: 2px 2px 2px rgba(0,0,0,0.3);
            position: relative;
        }
        /* ç²‰ç¬”å¤´ */
        .chalk-stick-icon::after {
            content: ''; position: absolute; right: -2px; top: 0; width: 5px; height: 100%;
            background: #eee; border-radius: 0 50% 50% 0;
        }

        .chalk-text-lg {
            font-family: "Long Cang", cursive;
            font-size: 28px; color: rgba(255,255,255,0.95);
            /* â˜ï¸ ç²‰ç¬”å­—è´¨æ„Ÿï¼šå¾®æ¨¡ç³Š + é¢—ç²’æ„Ÿé˜´å½± */
            text-shadow: 2px 2px 0px rgba(255,255,255,0.1), 0 0 2px rgba(255,255,255,0.4);
            letter-spacing: 2px;
        }

        .confirm-btns { display: flex; gap: 30px; }

        /* ================== 2. ä¿®æ­£ç‰ˆï¼šä¸¥æ ¼ç­‰å¤§çš„ç«‹ä½“é»‘æ¿æ“¦ ================== */
        .eraser-btn-3d {
            position: relative;
            /* ğŸ“ å¼ºåˆ¶ç»Ÿä¸€å°ºå¯¸ */
            width: 110px;
            height: 40px;
            border: none; outline: none; cursor: pointer;
            font-family: "Ma Shan Zheng", cursive; font-size: 18px; color: #fff;
            transition: transform 0.1s;
            display: flex; align-items: center; justify-content: center;
            /* è®©æ–‡å­—ç¨å¾®é ä¸Šä¸€ç‚¹ï¼Œè§†è§‰é‡å¿ƒæ›´ç¨³ */
            padding-bottom: 4px;
            margin: 0 10px; /* å¢åŠ ä¸€ç‚¹å·¦å³é—´è· */
        }

        /* --- æ ·å¼ A: ç»å…¸æœ¨è´¨ (ç¦»å¼€) --- */
        .style-wood {
            /* æœ¨å¤´çº¹ç†èƒŒæ™¯ */
            background: linear-gradient(to bottom, #8d6e63, #5d4037);
            border-radius: 4px 4px 2px 2px;
            text-shadow: 0 1px 1px rgba(0,0,0,0.5);

            /* ğŸ§± ä¸¥æ ¼æ§åˆ¶é˜´å½±é«˜åº¦ï¼šæ€»å…± 10px */
            box-shadow:
                0 3px 0 #3e2723,  /* 1. æ·±è‰²æœ¨å¤´å±‚ (3px) */
                0 6px 0 #212121,  /* 2. é»‘è‰²ç¡¬æ¯¡å±‚ (3px) */
                0 10px 0 #eeeeee, /* 3. ç™½è‰²ç²‰ç¬”ç°å±‚ (4px) -> è§†è§‰é‡ç‚¹ */
                0 15px 10px rgba(0,0,0,0.5); /* 4. æŠ•å½± */
        }

        /* --- æ ·å¼ B: è“è‰²å¡‘æ–™ (å†æƒ³æƒ³) --- */
        .style-plastic {
            /* è“è‰²å¡‘æ–™èƒŒæ™¯ */
            background: linear-gradient(to bottom, #42a5f5, #1565c0);
            border-radius: 4px 4px 2px 2px;
            text-shadow: 0 1px 1px rgba(0,0,0,0.3);

            /* ğŸ§± ä¸¥æ ¼æ§åˆ¶é˜´å½±é«˜åº¦ï¼šä¹Ÿæ˜¯ 10pxï¼Œç¡®ä¿å¯¹é½ */
            box-shadow:
                0 3px 0 #0d47a1,  /* 1. æ·±è“å¡‘æ–™å±‚ (3px) */
                0 6px 0 #333333,  /* 2. é»‘è‰²ç¡¬æ¯¡å±‚ (3px) */
                0 10px 0 #546e7a, /* 3. ç°è‰²è½¯æ¯¡å±‚ (4px) -> å¯¹åº”ä¸Šé¢çš„ç™½è‰²å±‚ */
                0 15px 10px rgba(0,0,0,0.5); /* 4. æŠ•å½± */
        }

        /* æŒ‰ä¸‹æ•ˆæœï¼šä¸¤ä¸ªæŒ‰é’®ä¸‹æ²‰é«˜åº¦å¿…é¡»ä¸€è‡´ */
        .eraser-btn-3d:active {
            transform: translateY(6px); /* å‘ä¸‹æŒ‰å‹ */
        }

        /* æŒ‰ä¸‹æ—¶å‹ç¼©é˜´å½±ï¼Œä¿æŒä¸€è‡´çš„å‹ç¼©æ„Ÿ */
        .style-wood:active {
            box-shadow: 0 0 0 #3e2723, 0 1px 0 #212121, 0 4px 0 #eeeeee, 0 4px 5px rgba(0,0,0,0.3);
        }
        .style-plastic:active {
            box-shadow: 0 0 0 #0d47a1, 0 1px 0 #333333, 0 4px 0 #546e7a, 0 4px 5px rgba(0,0,0,0.3);
        }

        /* â­ï¸ ä¿®å¤ï¼šLoading æ–‡å­—æ‚¬æµ®å±…ä¸­æ ·å¼ â­ï¸ */
        .report-img-container p {
            position: absolute; /* ç»å¯¹å®šä½ï¼Œä¸å†å ä½ç½® */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* ç²¾ç¡®å±…ä¸­ */

            /* ç¾åŒ–ä¸€ä¸‹ï¼šåŠ ä¸ªåŠé€æ˜é»‘åº•ï¼Œè®©å­—çœ‹å¾—æ›´æ¸…æ¥š */
            background: rgba(0, 0, 0, 0.6);
            color: #fff !important; /* å¼ºåˆ¶ç™½è‰²æ–‡å­— */
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            z-index: 10; /* ä¿è¯æµ®åœ¨å›¾ç‰‡ä¸Šé¢ */
            pointer-events: none; /* è®©é¼ æ ‡å¯ä»¥ç©¿é€å®ƒ */

            /* åŠ ä¸ªå°åŠ¨ç”» */
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        /* ç¿»é¡µæŒ‰é’®æ ·å¼ä¼˜åŒ– */
        .btn-chalk-nav {
            background: transparent;
            border: 2px solid rgba(255,255,255,0.5);
            color: #fff;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.2s;
        }
        .btn-chalk-nav:hover:not(:disabled) {
            border-color: #f1c40f;
            color: #f1c40f;
            background: rgba(255,255,255,0.1);
            transform: scale(1.05);
        }
        .btn-chalk-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            border-color: #555;
        }
    </style>
</head>
<body>

    <div id="vote-entry-btn">
        <div class="pen-wrapper">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 180">
                <defs>
                    <linearGradient id="bodyGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#1a1a1a"/>
                        <stop offset="40%" style="stop-color:#4a4a4a"/>
                        <stop offset="100%" style="stop-color:#000000"/>
                    </linearGradient>
                    <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#cfa550"/>
                        <stop offset="50%" style="stop-color:#ffecb3"/>
                        <stop offset="100%" style="stop-color:#9e7d30"/>
                    </linearGradient>
                </defs>
                <path fill="url(#bodyGrad)" d="M15,140 L12,20 C10,8 15,0 30,0 C45,0 50,8 48,20 L45,140 Z" />
                <rect x="13" y="130" width="34" height="4" fill="url(#goldGrad)" />
                <rect x="14" y="136" width="32" height="1.5" fill="url(#goldGrad)" />
                <path fill="#111" d="M15,140 L18,155 L42,155 L45,140 Z" />
                <path fill="url(#goldGrad)" d="M20,155 L30,175 L40,155 Z" />
                <line x1="30" y1="155" x2="30" y2="170" stroke="#000" stroke-width="0.5" />
                <path fill="url(#goldGrad)" d="M48,15 L50,18 L50,45 C50,48 47,48 47,45 L47,18 Z" />
            </svg>
        </div>

        <div class="paper-wrapper">
            <div class="paper-svg-container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 210">
                    <defs>
                        <linearGradient id="paperBase" x1="0" y1="0" x2="1" y2="1">
                            <stop offset="0%" stop-color="#fffdf5" />
                            <stop offset="100%" stop-color="#f2e6cf" />
                        </linearGradient>
                        <linearGradient id="foldShadow" x1="0" y1="0" x2="1" y2="1">
                            <stop offset="0%" stop-color="#e0d0b0" />
                            <stop offset="100%" stop-color="#fff" />
                        </linearGradient>
                        <filter id="softShadow">
                            <feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.1"/>
                        </filter>
                    </defs>
                    <path fill="url(#paperBase)" filter="url(#softShadow)" d="M 5,5 L 105,5 L 135,35 L 135,195 Q 100,205 70,200 T 5,195 Z" />
                    <path fill="url(#foldShadow)" d="M 105,5 L 105,35 L 135,35 Z" stroke="#dcc" stroke-width="0.5"/>
                    <path fill="none" stroke="#d4c5a3" stroke-width="1" opacity="0.4" d="M 10,190 Q 70,200 130,190" />
                    <g stroke="#a89f91" stroke-width="0.5" opacity="0.3" stroke-dasharray="2,2">
                        <line x1="15" y1="70" x2="125" y2="70" />
                        <line x1="15" y1="120" x2="125" y2="120" />
                        <line x1="15" y1="170" x2="125" y2="170" />
                    </g>
                </svg>
            </div>

            <div class="text-container">
                <span class="movable-item ink-char">ä¸º</span>
                <span class="movable-item ink-char font-special">TA</span>
                <span class="movable-item ink-char">æ’‘</span>
                <span class="movable-item ink-char">è…°</span>
                <div class="movable-item star-container">
                    <div class="star-rotator"><span class="magic-star">âœ¨</span></div>
                </div>
            </div>
        </div>
    </div>

    <div id="custom-alert-modal">
        <div class="small-blackboard">
            <div class="alert-msg">è¯·è¾“å…¥æ­£ç¡®çš„é¡µç </div>
            <button class="eraser-btn" onclick="document.getElementById('custom-alert-modal').style.display='none'">
                ç¡®å®š
            </button>
        </div>
    </div>

    <div id="confirm-close-modal">
            <div class="confirm-board">
                <div class="confirm-title-area">
                    <div class="chalk-stick-icon"></div>
                    <h2 class="chalk-text-lg">ç¡®å®šç¦»å¼€å—ï¼Ÿ</h2>
                </div>
                <div class="confirm-btns">
                    <button class="eraser-btn-3d style-wood" onclick="window.voteApp.realCloseBoard()">
                        ç¦» å¼€
                    </button>
                    <button class="eraser-btn-3d style-plastic" onclick="window.voteApp.cancelClose()">
                        å†æƒ³æƒ³
                    </button>
                </div>
            </div>
        </div>

    {% verbatim %}
    <div id="blackboard-modal">
        <div class="blackboard" id="vote-app">
            <div class="board-header">
                <span class="close-board" @click="closeBoard">Ã—</span>
                <h2 class="chalk-title">âœï¸ ä¸ºä½ å–œæ¬¢çš„äººç‰©æ‹‰ä¸€ç¥¨å§</h2>
                <button class="chalk-report-btn" @click="openReport">
                    <div class="star-magnet"></div>
                    <span class="magnet-text">æŸ¥çœ‹æŠ¥è¡¨</span>
               </button>
            </div>

            <!-- ä¿®æ”¹ report-overlay å†…éƒ¨ç»“æ„ -->
            <div class="report-overlay" v-if="showReport">
                <h3 style="color: #f1c40f; margin: 0 0 10px 0; font-size: 24px;">
                    <span v-if="reportPage === 1">ğŸ“Š å®æ—¶æ•°æ®åˆ†æï¼ˆæŸ±çŠ¶å›¾ï¼‰</span>
                    <span v-else-if="reportPage === 2">ğŸ° å®æ—¶æ•°æ®åˆ†æï¼ˆé¥¼çŠ¶å›¾ï¼‰</span>
                    <span v-else-if="reportPage === 3">ğŸ“ˆ å®æ—¶æ•°æ®åˆ†æï¼ˆæŠ˜çº¿å›¾ï¼‰</span>
                    <span v-else>ğŸ•¸ï¸ å®æ—¶æ•°æ®åˆ†æï¼ˆé›·è¾¾å›¾ï¼‰</span>
                </h3>

                <div class="report-img-container">
                    <p v-if="loadingReport" style="color: #fff; font-size: 20px;">æ­£åœ¨ç»˜åˆ¶å›¾è¡¨...</p>
                    <img v-if="reportImage" :src="reportImage" alt="ç»Ÿè®¡æŠ¥è¡¨">
                </div>

                <div class="report-toolbar">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button class="btn-chalk-nav" @click="prevReportPage" :disabled="reportPage <= 1">â—€ ä¸Šä¸€é¡µ</button>
                        <span style="color: white; font-family: 'Long Cang', cursive; font-size: 22px; min-width: 80px; text-align: center;">
                            ç¬¬ {{ reportPage }} é¡µ
                        </span>
                        <button class="btn-chalk-nav" @click="nextReportPage" :disabled="reportPage >= 4">ä¸‹ä¸€é¡µ â–¶</button>
                    </div>

                    <div style="width: 2px; height: 30px; background: rgba(255,255,255,0.3);"></div>

                    <div style="display: flex; align-items: center; gap: 20px;">
                        <button class="btn-update" @click="fetchReport" style="font-size: 16px; padding: 8px 25px;">ğŸ”„ æ›´æ–°æ•°æ®</button>
                        <button class="btn-close-report" @click="showReport = false" style="font-size: 16px; padding: 8px 25px;">å…³é—­</button>
                    </div>
                </div>
            </div>

            <div class="board-content">
                <div class="char-grid">
                    <div class="char-item" v-for="(char, index) in paginatedCharacters" :key="char.id">
                        <div class="char-info">
                            <h4>{{ (currentPage-1)*pageSize + index + 1 }}. {{ char.name }}</h4>
                            <span>ã€Š{{ char.movie }}ã€‹</span>
                        </div>
                        <div class="vote-actions">
                            <button class="btn-chalk btn-like" @click="vote(char, 'like', $event)">
                                â¤ï¸ {{ char.likes }}
                            </button>
                            <button class="btn-chalk btn-dislike" @click="vote(char, 'dislike', $event)">
                                ğŸ¥š {{ char.dislikes }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="board-footer" v-if="totalPages > 1">
                <div class="page-btn" :class="{ disabled: currentPage === 1 }" @click="prevPage">â† ä¸Šä¸€é¡µ</div>
                <div class="page-info">ç¬¬ {{ currentPage }} / {{ totalPages }} é¡µ</div>
                <div class="page-jump">
                    <input type="number" v-model.number="jumpInput" @keyup.enter="jumpToPage" min="1" :max="totalPages">
                    <button class="btn-chalk btn-jump" @click="jumpToPage">Go</button>
                </div>
                <div class="page-btn" :class="{ disabled: currentPage === totalPages }" @click="nextPage">ä¸‹ä¸€é¡µ â†’</div>
            </div>
        </div>
    </div>
    {% endverbatim %}

    <script>
        window.addEventListener('load', function() {
            // â­ï¸ 1. äº¤äº’é€»è¾‘ï¼šé˜²é‡å  + éšæœºç‰¹æ•ˆ â­ï¸
            (function initInteraction() {
                const penBtn = document.querySelector('.pen-wrapper');
                const movableItems = document.querySelectorAll('.movable-item');
                const starRotator = document.querySelector('.star-rotator');
                let currentStarRotation = 0;

                if (!penBtn || movableItems.length === 0) return;

                // å®‰å…¨åŒºåŸŸé…ç½®
                const safeArea = {
                    minX: 25, maxX: 95,
                    minY: 40, maxY: 160
                };
                const itemRadius = 30;

                penBtn.addEventListener('mouseenter', () => {
                    const positions = [];
                    movableItems.forEach((item) => {
                        let x, y, overlap;
                        let attempts = 0;
                        //do...while å¾ªç¯ï¼Œåˆ©ç”¨å‹¾è‚¡å®šç† (Math.sqrt(...)) æ£€æŸ¥æ–°ç”Ÿæˆçš„åæ ‡æ˜¯å¦ä¼šå’Œå·²æœ‰çš„æ–‡å­—é‡å ã€‚å¦‚æœé‡å ï¼Œå°±é‡æ–°ç®—ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºä½ã€‚
                        do {
                            overlap = false;
                            x = safeArea.minX + Math.random() * (safeArea.maxX - safeArea.minX);
                            y = safeArea.minY + Math.random() * (safeArea.maxY - safeArea.minY);

                            for (let pos of positions) {
                                const dist = Math.sqrt(Math.pow(x - pos.x, 2) + Math.pow(y - pos.y, 2));
                                if (dist < itemRadius) { overlap = true; break; }
                            }
                            attempts++;
                        } while (overlap && attempts < 100);

                        positions.push({x, y});
                        item.style.left = x + 'px';
                        item.style.top = y + 'px';
                        item.classList.add('active');
                    });

                    if (starRotator) {
                        const randomAngle = 180 + Math.random() * 540;
                        const dir = Math.random() < 0.5 ? 1 : -1;
                        currentStarRotation += (randomAngle * dir);
                        starRotator.style.transform = `rotate(${currentStarRotation}deg)`;
                    }
                });
            })();

            // â­ï¸ 2. Vue åº”ç”¨ â­ï¸
            window.voteApp = new Vue({
                el: '#vote-app',
                data: {
                    characters: [],
                    currentPage: 1,
                    pageSize: 16,
                    jumpInput: '', // ğŸ‘ˆ ä¿®å¤1ï¼šè¿™é‡Œè¡¥ä¸Šäº†é€—å·
                    showReport: false,
                    reportImage: '',
                    loadingReport: false,
                    reportPage: 1, // â­ï¸ æ–°å¢ï¼šå½“å‰æŠ¥è¡¨é¡µç ï¼Œé»˜è®¤ä¸º 1
                },
                computed: {
                    totalPages() { return Math.ceil(this.characters.length / this.pageSize); },
                    paginatedCharacters() {
                        const start = (this.currentPage - 1) * this.pageSize;
                        return this.characters.slice(start, start + this.pageSize);
                    }
                },
                methods: {
                    nextPage() { if (this.currentPage < this.totalPages) this.currentPage++; },
                    prevPage() { if (this.currentPage > 1) this.currentPage--; },

                    jumpToPage() {
                        let p = parseInt(this.jumpInput);
                        if (p >= 1 && p <= this.totalPages) {
                            this.currentPage = p;
                            this.jumpInput = '';
                        } else {
                            document.getElementById('custom-alert-modal').style.display = 'flex';
                        }
                    },

                    openBoard() {
                        document.getElementById('blackboard-modal').style.display = 'flex';
                        this.loadCharacters();
                    },
                   // ä¿®æ”¹è¿™ä¸ªæ–¹æ³•
                    closeBoard() {
                        // åŸæ¥æ˜¯ç›´æ¥å…³é—­ï¼šdocument.getElementById('blackboard-modal').style.display = 'none';
                        // ç°åœ¨æ”¹ä¸ºï¼šæ˜¾ç¤ºç¡®è®¤å¼¹çª—
                        document.getElementById('confirm-close-modal').style.display = 'flex';
                    },

                    // çœŸæ­£çš„å…³é—­ (ç‚¹å‡»â€œç¦»å¼€â€æ—¶è§¦å‘)
                    realCloseBoard() {
                        document.getElementById('blackboard-modal').style.display = 'none';
                        document.getElementById('confirm-close-modal').style.display = 'none';
                        // å¯é€‰ï¼šä½ å¯ä»¥åœ¨è¿™é‡ŒåŠ ä¸€ä¸ªä¿å­˜æ•°æ®çš„é€»è¾‘
                    },

                    // å–æ¶ˆå…³é—­ (ç‚¹å‡»â€œå†æƒ³æƒ³â€æ—¶è§¦å‘)
                    cancelClose() {
                        document.getElementById('confirm-close-modal').style.display = 'none';
                    },

                    // â­ï¸ ä¿®å¤2ï¼šloadCharacters æ–¹æ³•æ­£ç¡®ç»“æŸ
                    loadCharacters() {
                        axios.get('/api/vote/list')
                        .then(res => { this.characters = res.data; this.loadLocalVotes(); })
                        .catch(err => {
                            // å¦‚æœåç«¯æ²¡æ•°æ®ï¼Œä½¿ç”¨å…œåº•æ•°æ®
                            if (this.characters.length === 0) {
                                // ä¸ºäº†ä»£ç ç®€æ´ï¼Œè¿™é‡Œçœç•¥äº†å¾ˆé•¿çš„æ•°æ®åˆ—è¡¨ï¼Œå®é™…è¿è¡Œä¿ç•™åŸæœ‰çš„é•¿åˆ—è¡¨å³å¯
                                // æˆ–è€…ä½ å¯ä»¥ç¡®ä¿åç«¯ /api/vote/list èƒ½è¿”å›æ•°æ®
                                 const fullData = [
                                    {"id": 1, "name": "éƒ­é– (è‚–æˆ˜é¥°)", "movie": "å°„é›•è‹±é›„ä¼ ", "likes": 0, "dislikes": 0},
                                    // ... (ç”±äºç¯‡å¹…åŸå› ï¼Œå¦‚æœä½ åç«¯æœ‰æ•°æ®ï¼Œè¿™é‡Œä¸å†™æ»¡ä¹Ÿæ²¡å…³ç³»ï¼›
                                    // å¦‚æœä¾èµ–å‰ç«¯æ•°æ®ï¼Œè¯·æŠŠä½ åŸæ¥çš„é•¿åˆ—è¡¨è´´å›æ¥) ...
                                ];
                                // æ³¨æ„ï¼šå¦‚æœä½ æœ¬åœ°æ²¡æœ‰ backend æ•°æ®ï¼Œè¯·æŠŠä½ ä¹‹å‰çš„ fullData 320ä¸ªäººç‰©åˆ—è¡¨å®Œæ•´çš„è´´å›è¿™é‡Œ
                                // this.characters = fullData;
                                this.loadLocalVotes();
                            }
                        });
                    }, // ğŸ‘ˆ æ³¨æ„è¿™é‡Œï¼šloadCharacters ç»“æŸäº†ï¼ŒåŠ äº†é€—å·

                    // â­ï¸ ä¿®å¤3ï¼šopenReport æ”¾åœ¨ loadCharacters å¤–é¢
                    // æ‰“å¼€æŠ¥è¡¨æ—¶ï¼Œé‡ç½®ä¸ºç¬¬1é¡µ
                    openReport() {
                        this.showReport = true;
                        this.reportPage = 1; // æ¯æ¬¡æ‰“å¼€éƒ½çœ‹ç¬¬ä¸€é¡µ
                        this.fetchReport();
                    },

                    // ä¸Šä¸€é¡µ
                    prevReportPage() {
                        if (this.reportPage > 1) {
                            this.reportPage--;
                            this.fetchReport();
                        }
                    },

                    // ä¸‹ä¸€é¡µ
                    nextReportPage() {
                        if (this.reportPage < 4) {
                            this.reportPage++;
                            this.fetchReport();
                        }
                    },

                    // è·å–æŠ¥è¡¨ (å¸¦ä¸Š page å‚æ•°)
                    fetchReport() {
                        this.loadingReport = true;
                        const startTime = Date.now();

                        // â­ï¸ å…³é”®ä¿®æ”¹ï¼šURL åŠ ä¸Š ?page=X
                        axios.get(`/api/vote/stats?page=${this.reportPage}`)
                            .then(res => {
                                if (res.data.status === 'success') {
                                    this.reportImage = res.data.image;
                                }
                            })
                            .catch(err => {
                                console.error("å›¾è¡¨åŠ è½½å¤±è´¥", err);
                            })
                            .finally(() => {
                                const duration = Date.now() - startTime;
                                const minTime = 800;
                                const waitTime = Math.max(0, minTime - duration);
                                setTimeout(() => {
                                    this.loadingReport = false;
                                }, waitTime);
                            });
                    },

                    loadLocalVotes() {
                        try {
                            const localData = JSON.parse(localStorage.getItem('char_vote_record') || '{}');
                            this.characters.forEach(char => {
                                if (localData[char.id]) {
                                    char.likes = Math.max(char.likes, localData[char.id].likes || 0);
                                    char.dislikes = Math.max(char.dislikes, localData[char.id].dislikes || 0);
                                }
                            });
                        } catch(e) {}
                    },
                    saveLocalVotes(char) {
                        try {
                            const localData = JSON.parse(localStorage.getItem('char_vote_record') || '{}');
                            localData[char.id] = { likes: char.likes, dislikes: char.dislikes };
                            localStorage.setItem('char_vote_record', JSON.stringify(localData));
                        } catch(e) {}
                    },
                    vote(char, type, event) {
                        if (type === 'like') char.likes++; else char.dislikes++;
                        this.saveLocalVotes(char);
                        axios.post('/api/vote/action', { id: char.id, type: type }).catch(()=>{});
                        this.showEffect(type, event);
                    },
                    showEffect(type, event) {
                        const rect = event.target.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const centerY = rect.top + rect.height / 2;
                        let container = document.getElementById('effect-overlay');
                        if (!container) {
                            container = document.createElement('div');
                            container.id = 'effect-overlay';
                            container.className = 'effect-container';
                            document.body.appendChild(container);
                        }
                        if (type === 'like') {
                            const el = document.createElement('div');
                            el.innerHTML = 'â¤ï¸'; el.className = 'anim-heart-float';
                            el.style.left = centerX + 'px'; el.style.top = centerY + 'px';
                            container.appendChild(el); setTimeout(() => el.remove(), 1000);
                        } else {
                            this.createRealisticEggSplash(container, centerX, centerY);
                        }
                    },
                    createRealisticEggSplash(container, x, y) {
                        const white = document.createElement('div');
                        white.className = 'egg-white-blob';
                        const r = () => 40 + Math.random() * 30;
                        white.style.borderRadius = `${r()}% ${r()}% ${r()}% ${r()}% / ${r()}% ${r()}% ${r()}% ${r()}%`;
                        white.style.width = (60 + Math.random() * 20) + 'px';
                        white.style.height = (50 + Math.random() * 20) + 'px';
                        white.style.left = x + 'px'; white.style.top = y + 'px';
                        white.style.transform = `translate(-50%, -50%) rotate(${Math.random()*360}deg)`;
                        container.appendChild(white);
                        const yolk = document.createElement('div');
                        yolk.className = 'egg-yolk-blob';
                        yolk.style.left = x + 'px'; yolk.style.top = y + 'px';
                        container.appendChild(yolk);
                        setTimeout(() => { white.remove(); yolk.remove(); }, 1200);
                    }
                }
            });

            // 3. æ‹–æ‹½ä¸ç‚¹å‡»é€»è¾‘ (è¿™éƒ¨åˆ†ä»£ç ä¹‹å‰è¢« JS é”™è¯¯é˜»å¡äº†ï¼Œç°åœ¨åº”è¯¥èƒ½è¿è¡Œäº†)
            (function initDraggable() {
                const container = document.getElementById('vote-entry-btn');
                let isDragging = false, hasMoved = false, startX, startY, initialLeft, initialTop;

                function isValidTarget(target) {
                    if (target.closest('.pen-wrapper')) return false;
                    return true;
                }

                function onDragStart(e) {
                    if (!isValidTarget(e.target)) return;
                    const evt = e.touches ? e.touches[0] : e;
                    isDragging = true; hasMoved = false;
                    startX = evt.clientX; startY = evt.clientY;
                    const rect = container.getBoundingClientRect();
                    initialLeft = rect.left; initialTop = rect.top;
                    if(e.cancelable && !e.target.closest('.blackboard')) e.preventDefault();
                }

                function onDragMove(e) {
                    if (!isDragging) return;
                    const evt = e.touches ? e.touches[0] : e;
                    const dx = evt.clientX - startX;
                    const dy = evt.clientY - startY;
                    if (Math.abs(dx) > 3 || Math.abs(dy) > 3) hasMoved = true;
                    let newLeft = initialLeft + dx;
                    let newTop = initialTop + dy;
                    const maxLeft = window.innerWidth - container.offsetWidth;
                    const maxTop = window.innerHeight - container.offsetHeight;
                    container.style.left = Math.max(0, Math.min(newLeft, maxLeft)) + 'px';
                    container.style.top = Math.max(0, Math.min(newTop, maxTop)) + 'px';
                }

                function onDragEnd() {
                    if (!isDragging) return;
                    isDragging = false;
                    // â­ï¸ è¿™é‡Œæ§åˆ¶ç‚¹å‡»ï¼šå¦‚æœæ²¡æœ‰ç§»åŠ¨ï¼Œå°±è®¤ä¸ºæ˜¯ç‚¹å‡»ï¼Œæ‰“å¼€é»‘æ¿
                    if (!hasMoved) window.voteApp.openBoard();
                }

                container.addEventListener('mousedown', onDragStart);
                window.addEventListener('mousemove', onDragMove);
                window.addEventListener('mouseup', onDragEnd);
                container.addEventListener('touchstart', onDragStart, {passive:false});
                window.addEventListener('touchmove', onDragMove, {passive:false});
                window.addEventListener('touchend', onDragEnd);
            })();
        });
    </script>
</body>
</html>